import{a as ee}from"./chunk-BHEACCP3.js";import{a as Z,f as q,i as J,j as Q,l as W,n as X}from"./chunk-S3XCMD5U.js";import{A as k,C as f,D as _,E as v,Fa as K,G as y,I as E,K as N,L,M as D,R as B,e as d,f as I,g as S,h as M,ha as F,i as p,ia as A,j as n,ja as V,k as o,ka as j,l as x,la as Y,na as T,oa as R,qa as U,s as a,sa as $,t as m,u as O,ua as G,v as w,wa as H,z as P}from"./chunk-PCYDMJPV.js";import"./chunk-W6H37XDB.js";import"./chunk-7KGURMOZ.js";import"./chunk-YK4DTNHI.js";import"./chunk-YK3APVNZ.js";import"./chunk-366LSZGT.js";import"./chunk-JVTPOORY.js";import"./chunk-CLDSZD2A.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-4YRHGV2P.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import"./chunk-JHI3MBHO.js";function se(c,u){if(c&1&&(n(0,"ion-col",11)(1,"ion-card",16)(2,"ion-card-header",17)(3,"div",18),x(4,"ion-icon",19),n(5,"ion-card-subtitle"),a(6),o()()(),n(7,"ion-card-content")(8,"ion-card-title",20),a(9),f(10,"currency"),o(),n(11,"div",21),a(12),f(13,"currency"),o()()()()),c&2){let l=u.$implicit;d(),p("routerLink",P(l.link)),d(3),p("name",l.icon),d(2),m(l.title),d(3),m(v(10,7,l.value,"EUR","symbol","1.2-2")),d(3),w("\u2014 ",v(13,12,l.subValue,"EUR","symbol","1.2-2")," ",l.subLabel)}}function le(c,u){if(c&1&&(n(0,"ion-item",22)(1,"ion-grid",23)(2,"ion-row",8)(3,"ion-col",24)(4,"div",25),a(5),o()(),n(6,"ion-col",26)(7,"div",27),a(8),o()(),n(9,"ion-col",28)(10,"span",29),a(11),o()(),n(12,"ion-col",30),x(13,"ion-icon",31),n(14,"span",29),a(15),o()(),n(16,"ion-col",32),a(17),f(18,"date"),o()()()()),c&2){let l=u.$implicit;p("routerLink",k("/projekte/",l.nr)),d(5),m(l.name),d(3),m(l.nr),d(3),m(l.ausfuehrungsort),d(4),m(l.kunde),d(2),O(" ",_(18,7,l.letzteAenderung,"dd.MM.yyyy")," ")}}var ve=(()=>{let u=class u{constructor(i){this.dummy=i,this.projekteSig=this.dummy.projektesig,this.inArbeit=y(()=>this.projekteSig().filter(e=>e.status.toLowerCase().includes("arbeit"))),this.cards=y(()=>{let e=new Date,{currentYear:r,currentMonth:t,previousYear:s,previousMonth:g}=this.resolveMonths(e),z=this.projekteSig(),h=z.flatMap(b=>b.rechnungen??[]),C=z.flatMap(b=>b.angebote??[]),te=this.sumInvoiceNetByMonth(h,r,t),ne=this.sumInvoiceNetByMonth(h,s,g),ie=this.sumOfferNetByMonth(C,r,t),oe=this.sumOfferNetByMonth(C,s,g),re=this.sumPaidInvoicesByMonth(h,r,t),ae=this.sumPaidInvoicesByMonth(h,s,g);return[{title:"Umsatz diesen Monat",value:te,subValue:ne,subLabel:"im Vormonat",icon:"cash-outline",link:"/umsatz"},{title:"Angebote diesen Monat",value:ie,subValue:oe,subLabel:"im Vormonat",icon:"document-text-outline",link:"/angebote"},{title:"Zahlungen diesen Monat",value:re,subValue:ae,subLabel:"im Vormonat",icon:"card-outline",link:"/zahlungen"}]}),Z({cashOutline:Q,documentTextOutline:X,cardOutline:J,chevronForwardOutline:W,businessOutline:q}),this.dummy.createProjects()}getStatusColor(i){let e=i.toLowerCase();return e.includes("geplant")?"primary":e.includes("arbeit")?"tertiary":e.includes("angebot")?"warning":e.includes("rechnung")?"medium":e.includes("abgeschlossen")?"success":e.includes("storniert")||e.includes("abgelehnt")?"danger":"medium"}resolveMonths(i){let e=i.getFullYear(),r=i.getMonth(),t=new Date(e,r-1,1);return{currentYear:e,currentMonth:r,previousYear:t.getFullYear(),previousMonth:t.getMonth()}}isSameMonth(i,e,r){if(i==null)return!1;let t=i instanceof Date?i:new Date(i);return Number.isNaN(t.getTime())?!1:t.getFullYear()===e&&t.getMonth()===r}sumInvoiceNetByMonth(i,e,r){return i.reduce((t,s)=>this.isSameMonth(s.datum,e,r)?t+(s.betragNetto??0):t,0)}sumOfferNetByMonth(i,e,r){return i.reduce((t,s)=>this.isSameMonth(s.datum,e,r)?t+(s.betragNetto??0):t,0)}sumPaidInvoicesByMonth(i,e,r){return i.reduce((t,s)=>!(s.status??"").toLowerCase().includes("bezahlt")||!this.isSameMonth(s.datum,e,r)?t:t+(s.betragBrutto??s.betragNetto??0),0)}};u.\u0275fac=function(e){return new(e||u)(I(ee))},u.\u0275cmp=S({type:u,selectors:[["app-dashboard"]],decls:28,vars:2,consts:[[1,"listContent"],["fixed",""],["size","12"],[1,"page-heading"],[1,"cards"],["size","12","size-md","4",4,"ngFor","ngForOf"],[1,"page-heading",2,"margin-top","16px"],["fixed","",1,"row-grid","header","ion-padding-start","ion-padding-end"],[1,"ion-align-items-center"],["size","12","size-md","3"],["size","6","size-md","1"],["size","12","size-md","4"],["size","12","size-md","2"],["size","6","size-md","2",1,"right"],[1,"table-list"],["button","","lines","full","detail","false","class","table-row",3,"routerLink",4,"ngFor","ngForOf"],["button","",1,"stat-card",3,"routerLink"],[1,"card-head"],[1,"left"],[3,"name"],[1,"value"],[1,"sub"],["button","","lines","full","detail","false",1,"table-row",3,"routerLink"],["fixed","",1,"row-grid"],["size","12","size-md","3",1,"name"],[1,"primary","ellipsis"],["size","6","size-md","1",1,"nr"],[1,"muted","ellipsis"],["size","12","size-md","4",1,"ort"],[1,"ellipsis"],["size","12","size-md","2",1,"kunde"],["name","business-outline"],["size","6","size-md","2",1,"changed"]],template:function(e,r){e&1&&(n(0,"ion-content",0)(1,"ion-grid",1)(2,"ion-row")(3,"ion-col",2)(4,"div",3),a(5,"\xDCberblick"),o()()(),n(6,"ion-row",4),M(7,se,14,17,"ion-col",5),o(),n(8,"ion-row")(9,"ion-col",2)(10,"div",6),a(11,"Projekte in Arbeit"),o()()(),n(12,"ion-row")(13,"ion-col",2)(14,"ion-grid",7)(15,"ion-row",8)(16,"ion-col",9),a(17,"Name"),o(),n(18,"ion-col",10),a(19,"Nr."),o(),n(20,"ion-col",11),a(21,"Ausf\xFChrungsort"),o(),n(22,"ion-col",12),a(23,"Kunde"),o(),n(24,"ion-col",13),a(25,"Letzte \xC4nderung"),o()()(),n(26,"ion-list",14),M(27,le,19,10,"ion-item",15),o()()()()()),e&2&&(d(7),p("ngForOf",r.cards()),d(20),p("ngForOf",r.inArbeit()))},dependencies:[R,F,V,Y,j,A,U,H,T,G,$,B,K,D,E,N,L],styles:[".stat-card[_ngcontent-%COMP%]{border-radius:16px;box-shadow:0 6px 18px #0000000f}.card-head[_ngcontent-%COMP%]{margin-bottom:20px}.card-head[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.card-head[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;color:var(--ion-color-medium)}.value[_ngcontent-%COMP%]{font-weight:700;letter-spacing:-.3px;font-size:1.8rem}.sub[_ngcontent-%COMP%]{margin-top:6px;color:var(--ion-color-medium);font-size:.9rem}.cards[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{margin-bottom:16px}ion-list[_ngcontent-%COMP%]{border-radius:10px}ion-item[_ngcontent-%COMP%]{padding-top:10px;padding-bottom:10px}.header[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-weight:500;margin-bottom:6px}"]});let c=u;return c})();export{ve as DashboardPage};
