import{a as h,d}from"./chunk-XY2HQUN5.js";import{a as s,b as o}from"./chunk-JHI3MBHO.js";var w=(()=>{let u=class u{constructor(){this.STORAGE_KEY="dummy.projects.v1",this._projekte=d(this.load()??[]),this.projektesig=this._projekte.asReadonly(),this.createProjects()}createProjects(n=!1){if(!n&&this._projekte().length)return;let t=[{name:"Sanierung Altbau Traveplatz",nr:"22-00114",status:"Abgeschlossen",ausfuehrungsort:"M\xFCggelstra\xDFe 18, 10247 Berlin",kunde:"Frank K\xF6hler",letzteAenderung:new Date("2025-03-17"),beschreibung:"Sanierungsarbeiten im Altbau am Traveplatz.",umsatz:43244.36,ausgaben:29800,offenerBetrag:0,termine:[{datum:new Date("2025-03-17"),vonBis:"08:00 - 18:00",status:"Geplant",name:"Aufma\xDF",mitarbeiter:"CM"}],angebote:[{datum:new Date("2025-03-17"),nr:"-",status:"Entwurf",name:"Angebot",erstelltVon:"CM",betrag:0}],rechnungen:[{datum:new Date("2025-03-18"),nr:"R-1267",status:"Bezahlt",betragNetto:43244.36,betragBrutto:51460.79}]},{name:"Dachausbau Prenzlauer Berg",nr:"23-00021",status:"In Arbeit",ausfuehrungsort:"Sch\xF6nhauser Allee 87, 10439 Berlin",kunde:"Sabine Hoffmann",letzteAenderung:new Date("2025-05-10"),beschreibung:"Dachisolierung und Innenausbau.",umsatz:12500,ausgaben:7300,offenerBetrag:5200,termine:[{datum:new Date("2025-03-20"),vonBis:"12:30 - 17:00",status:"Best\xE4tigt",name:"Vor Ort",mitarbeiter:"LZ"}],angebote:[{datum:new Date("2025-03-10"),nr:"A-1225",status:"Akzeptiert",name:"Komplettangebot",erstelltVon:"LZ",betrag:23800}],rechnungen:[{datum:new Date("2025-03-28"),nr:"R-2201",status:"Offen",betragNetto:18600,faelligAm:new Date("2025-04-27")}]},{name:"Heizungserneuerung Kreuzberg",nr:"23-00045",status:"Geplant",ausfuehrungsort:"Gneisenaustra\xDFe 42, 10961 Berlin",kunde:"Bau GmbH M\xFCller",letzteAenderung:new Date("2025-09-12"),beschreibung:"Austausch der Heizungsanlage.",umsatz:0,ausgaben:0,offenerBetrag:8e3,termine:[{datum:new Date("2025-04-02"),vonBis:"09:00 - 11:00",status:"Geplant",name:"Besprechung",mitarbeiter:"AN"}],angebote:[{datum:new Date("2025-03-29"),nr:"A-1300",status:"Versendet",name:"Heizungspaket",erstelltVon:"AN",betrag:8e3}],rechnungen:[]},{name:"Badsanierung Mitte",nr:"23-00089",status:"In Arbeit",ausfuehrungsort:"Torstra\xDFe 78, 10119 Berlin",kunde:"Lars Neumann",letzteAenderung:new Date("2025-10-05"),beschreibung:"Komplettsanierung Bad.",umsatz:8600,ausgaben:5200,offenerBetrag:3400,termine:[{datum:new Date("2025-03-22"),vonBis:"08:00 - 16:00",status:"Geplant",name:"Demontage",mitarbeiter:"CM"}],angebote:[{datum:new Date("2025-03-12"),nr:"A-1270",status:"Akzeptiert",name:"Badsanierung",erstelltVon:"CM",betrag:12e3}],rechnungen:[{datum:new Date("2025-03-30"),nr:"R-2305",status:"Teilgezahlt",betragNetto:6e3,faelligAm:new Date("2025-04-29")}]},{name:"Neubau Einfamilienhaus",nr:"23-00110",status:"Abgeschlossen",ausfuehrungsort:"Grunewaldstra\xDFe 5, 14193 Berlin",kunde:"Familie Schulz",letzteAenderung:new Date("2025-12-22"),beschreibung:"Rohbau und Innenausbau abgeschlossen.",umsatz:98e3,ausgaben:75400,offenerBetrag:0,termine:[{datum:new Date("2025-02-01"),vonBis:"Ganzt\xE4gig",status:"Erledigt",name:"Abnahme",mitarbeiter:"MS"}],angebote:[{datum:new Date("2024-11-10"),nr:"A-0999",status:"Akzeptiert",name:"Generalunternehmer",erstelltVon:"MS",betrag:98e3}],rechnungen:[{datum:new Date("2025-02-10"),nr:"R-2001",status:"Bezahlt",betragNetto:98e3,betragBrutto:116620}]}];this._projekte.set(t),this.save()}getProjekte(){return this._projekte()}findByNr(n){return this._projekte().find(t=>t.nr===n)}updateProject(n,t){let a=this._projekte().map(e=>e.nr!==n?e:o(s(s({},e),t),{letzteAenderung:new Date}));this._projekte.set(a),this.save()}addTermin(n,t){let a=this._projekte().map(e=>{if(e.nr!==n)return e;let r=[...e.termine??[],s({},t)];return o(s({},e),{termine:r,letzteAenderung:new Date})});this._projekte.set(a),this.save()}addAngebot(n,t){let a=this._projekte().map(e=>{if(e.nr!==n)return e;let r=[...e.angebote??[],s({},t)];return o(s({},e),{angebote:r,letzteAenderung:new Date})});this._projekte.set(a),this.save()}addRechnung(n,t,a=!0){let e=this._projekte().map(r=>{if(r.nr!==n)return r;let b=[...r.rechnungen??[],s({},t)],i=r.offenerBetrag;if(a){let g=(t.status||"").toLowerCase(),m=t.betragBrutto??t.betragNetto??0;g.includes("bezahlt")?i=Math.max(0,i-m):(g.includes("offen")||g.includes("teil")||g.includes("\xFCberf\xE4llig"))&&(i=i+m)}return o(s({},r),{rechnungen:b,offenerBetrag:i,letzteAenderung:new Date})});this._projekte.set(e),this.save()}save(){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(this._projekte()))}catch{}}load(){try{let n=localStorage.getItem(this.STORAGE_KEY);if(!n)return null;let t=JSON.parse(n);return t.forEach(a=>{a.letzteAenderung=new Date(a.letzteAenderung),a.termine?.forEach(e=>e.datum=new Date(e.datum)),a.angebote?.forEach(e=>e.datum=new Date(e.datum)),a.rechnungen?.forEach(e=>{e.datum=new Date(e.datum),e.faelligAm&&(e.faelligAm=new Date(e.faelligAm))})}),t}catch{return null}}};u.\u0275fac=function(t){return new(t||u)},u.\u0275prov=h({token:u,factory:u.\u0275fac,providedIn:"root"});let l=u;return l})();export{w as a};
