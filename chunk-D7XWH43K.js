import{a as ce}from"./chunk-DWTWEUSI.js";import{a as ie,i as oe,j as re,m as ae}from"./chunk-PRD3V2AJ.js";import{B as j,C as O,D as g,E as _,F as M,G as L,H as C,Ha as ne,J as A,K as F,L as V,M as T,N as R,S as Y,e as l,f as E,g as k,ga as $,h as v,i as m,j as r,ja as U,k as a,ka as G,l as w,la as H,m as z,ma as K,n as D,na as W,pa as Z,q as x,qa as q,r as B,s,sa as J,t as f,u as h,ua as Q,v as b,va as X,wa as ee,ya as te,z as N}from"./chunk-6T7TN4AG.js";import"./chunk-W6H37XDB.js";import"./chunk-7KGURMOZ.js";import"./chunk-YK4DTNHI.js";import"./chunk-YK3APVNZ.js";import"./chunk-366LSZGT.js";import"./chunk-JVTPOORY.js";import"./chunk-CLDSZD2A.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-4YRHGV2P.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import"./chunk-JHI3MBHO.js";var ge=o=>["/projekte",o],fe=(o,d)=>["/rechnungen",o,d],he=(o,d)=>["/angebote",o,d];function ve(o,d){if(o&1&&(r(0,"ion-col",15)(1,"ion-card",16)(2,"ion-card-header",17)(3,"div",18),w(4,"ion-icon",19),r(5,"ion-card-subtitle"),s(6),a()()(),r(7,"ion-card-content")(8,"ion-card-title",20),s(9),g(10,"currency"),a(),r(11,"div",21),s(12),g(13,"currency"),a()()()()),o&2){let n=d.$implicit;l(),m("routerLink",N(n.link)),l(3),m("name",n.icon),l(2),f(n.title),l(3),f(M(10,7,n.value,"EUR","symbol","1.2-2")),l(3),b("\u2014 ",M(13,12,n.subValue,"EUR","symbol","1.2-2")," ",n.subLabel)}}function xe(o,d){if(o&1&&(r(0,"ion-item",22)(1,"ion-label",23)(2,"div",24),s(3),a(),r(4,"div",25),s(5),g(6,"date"),a()(),r(7,"ion-badge",26),s(8),a()()),o&2){let n=d.$implicit,i=x();m("routerLink",j(9,ge,n.nr)),l(3),f(n.name),l(2),b("#",n.nr," \xB7 ",_(6,6,n.letzteAenderung,"dd.MM.yyyy")),l(2),m("color",i.getProjektStatusColor(n.status)),l(),h(" ",n.status," ")}}function be(o,d){o&1&&(r(0,"div",27),s(1,"Aktuell keine offenen Projekte."),a())}function _e(o,d){if(o&1&&(z(0),s(1),g(2,"date"),D()),o&2){let n=x().$implicit;l(),h("F\xE4llig am ",_(2,1,n.invoice.faelligAm,"dd.MM.yyyy"))}}function Me(o,d){if(o&1&&(s(0),g(1,"date")),o&2){let n=x().$implicit;h("Rechnungsdatum ",_(1,1,n.invoice.datum,"dd.MM.yyyy"))}}function Ce(o,d){if(o&1&&(r(0,"ion-item",22)(1,"ion-label",23)(2,"div",24),s(3),a(),r(4,"div",25),v(5,_e,3,4,"ng-container",28)(6,Me,2,4,"ng-template",null,0,L),a()(),r(8,"div",29)(9,"ion-badge",30),s(10),a(),r(11,"div",31),s(12),g(13,"currency"),a()()()),o&2){let n=d.$implicit,i=B(7),e=x();m("routerLink",O(13,fe,n.project.nr,n.index)),l(3),b("",n.invoice.nr," \xB7 ",n.project.name),l(2),m("ngIf",n.invoice.faelligAm)("ngIfElse",i),l(4),m("color",e.getInvoiceStatusColor(n.invoice.status)),l(),h(" ",n.invoice.status," "),l(2),f(M(13,8,n.invoice.betragBrutto??n.invoice.betragNetto,"EUR","symbol","1.2-2"))}}function ye(o,d){o&1&&(r(0,"div",27),s(1,"Keine offenen Rechnungen vorhanden."),a())}function Pe(o,d){if(o&1&&(r(0,"ion-item",22)(1,"ion-label",23)(2,"div",24),s(3),a(),r(4,"div",25),s(5),a(),r(6,"div",25),s(7),g(8,"date"),a()(),r(9,"div",29)(10,"ion-badge",30),s(11),a(),r(12,"div",31),s(13),g(14,"currency"),a()()()),o&2){let n=d.$implicit,i=x();m("routerLink",O(16,he,n.project.nr,n.index)),l(3),f(n.offer.name),l(2),b("",n.offer.nr," \xB7 ",n.project.name),l(2),h("Erstellt am ",_(8,8,n.offer.datum,"dd.MM.yyyy")),l(3),m("color",i.getOfferStatusColor(n.offer.status)),l(),h(" ",n.offer.status," "),l(2),f(M(14,11,n.offer.betragNetto,"EUR","symbol","1.2-2"))}}function Oe(o,d){o&1&&(r(0,"div",27),s(1,"Derzeit keine offenen Angebote."),a())}var Ae=(()=>{let d=class d{constructor(i){this.dummy=i,this.projekteSig=this.dummy.projektesig,this.cards=C(()=>{let e=new Date,{currentYear:t,currentMonth:c,previousYear:u,previousMonth:p}=this.resolveMonths(e),I=this.projekteSig(),y=I.flatMap(P=>P.rechnungen??[]),S=I.flatMap(P=>P.angebote??[]),le=this.sumInvoiceNetByMonth(y,t,c),se=this.sumInvoiceNetByMonth(y,u,p),de=this.sumOfferNetByMonth(S,t,c),ue=this.sumOfferNetByMonth(S,u,p),me=this.sumPaidInvoicesByMonth(y,t,c),pe=this.sumPaidInvoicesByMonth(y,u,p);return[{title:"Umsatz diesen Monat",value:le,subValue:se,subLabel:"im Vormonat",icon:"cash-outline",link:"/rechnungen"},{title:"Angebote diesen Monat",value:de,subValue:ue,subLabel:"im Vormonat",icon:"document-text-outline",link:"/angebote"},{title:"Zahlungen diesen Monat",value:me,subValue:pe,subLabel:"im Vormonat",icon:"card-outline",link:"/rechnungen"}]}),this.offeneProjekte=C(()=>this.projekteSig().filter(e=>{let t=(e.status??"").toLowerCase();return!(!t||t.includes("abgeschlossen")||t.includes("storniert"))}).sort((e,t)=>this.dateValue(t.letzteAenderung)-this.dateValue(e.letzteAenderung)).slice(0,5)),this.offeneRechnungen=C(()=>{let e=[];return this.projekteSig().forEach(t=>{(t.rechnungen??[]).forEach((c,u)=>{let p=(c.status??"").toLowerCase();p.includes("bezahlt")||p.includes("storniert")||e.push({project:t,invoice:c,index:u})})}),e.sort((t,c)=>this.dateValue(c.invoice.faelligAm??c.invoice.datum)-this.dateValue(t.invoice.faelligAm??t.invoice.datum)).slice(0,5)}),this.offeneAngebote=C(()=>{let e=[];return this.projekteSig().forEach(t=>{(t.angebote??[]).forEach((c,u)=>{let p=(c.status??"").toLowerCase();p.includes("akzeptiert")||p.includes("abgelehnt")||p.includes("storniert")||e.push({project:t,offer:c,index:u})})}),e.sort((t,c)=>this.dateValue(c.offer.datum)-this.dateValue(t.offer.datum)).slice(0,5)}),ie({cashOutline:re,documentTextOutline:ae,cardOutline:oe}),this.dummy.createProjects(!0)}getProjektStatusColor(i){let e=i.toLowerCase();return e.includes("geplant")?"primary":e.includes("arbeit")?"tertiary":e.includes("angebot")?"warning":e.includes("rechnung")?"medium":e.includes("abgeschlossen")?"success":e.includes("storniert")||e.includes("abgelehnt")?"danger":"medium"}getInvoiceStatusColor(i){let e=i.toLowerCase();return e.includes("\xFCberf\xE4llig")?"danger":e.includes("teil")?"tertiary":e.includes("offen")?"warning":e.includes("entwurf")?"medium":e.includes("bezahlt")?"success":(e.includes("storniert"),"medium")}getOfferStatusColor(i){let e=i.toLowerCase();return e.includes("versendet")?"primary":e.includes("entwurf")?"medium":e.includes("akzeptiert")?"success":e.includes("abgelehnt")?"danger":"warning"}resolveMonths(i){let e=i.getFullYear(),t=i.getMonth(),c=new Date(e,t-1,1);return{currentYear:e,currentMonth:t,previousYear:c.getFullYear(),previousMonth:c.getMonth()}}isSameMonth(i,e,t){if(i==null)return!1;let c=i instanceof Date?i:new Date(i);return Number.isNaN(c.getTime())?!1:c.getFullYear()===e&&c.getMonth()===t}sumInvoiceNetByMonth(i,e,t){return i.reduce((c,u)=>this.isSameMonth(u.datum,e,t)?c+(u.betragNetto??0):c,0)}sumOfferNetByMonth(i,e,t){return i.reduce((c,u)=>this.isSameMonth(u.datum,e,t)?c+(u.betragNetto??0):c,0)}sumPaidInvoicesByMonth(i,e,t){return i.reduce((c,u)=>!(u.status??"").toLowerCase().includes("bezahlt")||!this.isSameMonth(u.datum,e,t)?c:c+(u.betragBrutto??u.betragNetto??0),0)}dateValue(i){if(!i)return 0;let e=i instanceof Date?i:new Date(i);return Number.isNaN(e.getTime())?0:e.getTime()}};d.\u0275fac=function(e){return new(e||d)(E(ce))},d.\u0275cmp=k({type:d,selectors:[["app-dashboard"]],decls:48,vars:7,consts:[["invoiceDate",""],[1,"listContent"],["fixed",""],["size","12"],[1,"page-heading"],[1,"cards"],["size","12","size-md","4",4,"ngFor","ngForOf"],[1,"page-heading","section-heading"],[1,"section-subtitle"],[1,"overview"],["size","12","size-lg","4"],[1,"overview-card"],["lines","full"],["button","","detail","false",3,"routerLink",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],["size","12","size-md","4"],["button","",1,"stat-card",3,"routerLink"],[1,"card-head"],[1,"left"],[3,"name"],[1,"value"],[1,"sub"],["button","","detail","false",3,"routerLink"],[1,"ion-text-wrap"],[1,"item-title"],[1,"item-meta"],["slot","end",1,"status-badge",3,"color"],[1,"empty-state"],[4,"ngIf","ngIfElse"],["slot","end",1,"end-stack"],[1,"status-badge",3,"color"],[1,"amount"]],template:function(e,t){e&1&&(r(0,"ion-content",1)(1,"ion-grid",2)(2,"ion-row")(3,"ion-col",3)(4,"div",4),s(5,"\xDCberblick"),a()()(),r(6,"ion-row",5),v(7,ve,14,17,"ion-col",6),a(),r(8,"ion-row")(9,"ion-col",3)(10,"div",7),s(11,"Aktuelle \xDCbersicht"),a(),r(12,"div",8),s(13,"Wichtige offene Vorg\xE4nge auf einen Blick"),a()()(),r(14,"ion-row",9)(15,"ion-col",10)(16,"ion-card",11)(17,"ion-card-header")(18,"ion-card-title"),s(19,"Offene Projekte"),a(),r(20,"ion-card-subtitle"),s(21,"zuletzt bearbeitet"),a()(),r(22,"ion-card-content")(23,"ion-list",12),v(24,xe,9,11,"ion-item",13)(25,be,2,0,"div",14),a()()()(),r(26,"ion-col",10)(27,"ion-card",11)(28,"ion-card-header")(29,"ion-card-title"),s(30,"Offene Rechnungen"),a(),r(31,"ion-card-subtitle"),s(32,"n\xE4chste F\xE4lligkeiten"),a()(),r(33,"ion-card-content")(34,"ion-list",12),v(35,Ce,14,16,"ion-item",13)(36,ye,2,0,"div",14),a()()()(),r(37,"ion-col",10)(38,"ion-card",11)(39,"ion-card-header")(40,"ion-card-title"),s(41,"Offene Angebote"),a(),r(42,"ion-card-subtitle"),s(43,"zuletzt versendet"),a()(),r(44,"ion-card-content")(45,"ion-list",12),v(46,Pe,15,19,"ion-item",13)(47,Oe,2,0,"div",14),a()()()()()()()),e&2&&(l(7),m("ngForOf",t.cards()),l(17),m("ngForOf",t.offeneProjekte()),l(),m("ngIf",!t.offeneProjekte().length),l(10),m("ngForOf",t.offeneRechnungen()),l(),m("ngIf",!t.offeneRechnungen().length),l(10),m("ngForOf",t.offeneAngebote()),l(),m("ngIf",!t.offeneAngebote().length))},dependencies:[q,U,H,W,K,G,J,te,Z,ee,Q,Y,ne,R,A,F,$,X,V,T],styles:[".stat-card[_ngcontent-%COMP%]{border-radius:16px;box-shadow:0 6px 18px #0000000f}.card-head[_ngcontent-%COMP%]{margin-bottom:20px}.card-head[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.card-head[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;color:var(--ion-color-medium)}.value[_ngcontent-%COMP%]{font-weight:700;letter-spacing:-.3px;font-size:1.8rem}.sub[_ngcontent-%COMP%]{margin-top:6px;color:var(--ion-color-medium);font-size:.9rem}.cards[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{margin-bottom:16px}ion-list[_ngcontent-%COMP%]{border-radius:10px}ion-item[_ngcontent-%COMP%]{padding-top:10px;padding-bottom:10px}.header[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-weight:500;margin-bottom:6px}.section-heading[_ngcontent-%COMP%]{margin-top:24px;margin-bottom:4px}.section-subtitle[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:.95rem;margin-bottom:16px}.overview-card[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;box-shadow:0 8px 20px #00000014;border-radius:16px}.overview-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column}.overview-card[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{flex:1;margin-top:4px}.overview-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0;align-items:flex-start}.overview-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%] + ion-item[_ngcontent-%COMP%]{margin-top:4px}.item-title[_ngcontent-%COMP%]{font-weight:600;font-size:1rem;color:var(--ion-text-color, #000)}.item-meta[_ngcontent-%COMP%]{margin-top:4px;color:var(--ion-color-medium);font-size:.85rem}.amount[_ngcontent-%COMP%]{font-weight:600;font-size:.95rem;margin-left:12px;white-space:nowrap}.status-badge[_ngcontent-%COMP%]{text-transform:none;margin-left:8px}.end-stack[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:6px;margin-left:12px}.empty-state[_ngcontent-%COMP%]{padding:16px 12px;text-align:center;color:var(--ion-color-medium);font-size:.9rem}@media (max-width: 767px){.overview-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.overview-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .end-stack[_ngcontent-%COMP%]{align-items:flex-start;margin-left:0;margin-top:8px}}"]});let o=d;return o})();export{Ae as DashboardPage};
